# ä»»åŠ¡ç³»ç»Ÿè®¾è®¡æ–¹æ¡ˆ

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

- **å¿«é€Ÿè£‚å˜**ï¼šé€šè¿‡é‚€è¯·+åˆ†äº«æœºåˆ¶æ‰©å¤§ç”¨æˆ·
- **å†…å®¹æ¿€åŠ±**ï¼šé¼“åŠ±ç”¨æˆ·å‘å¸ƒä¼˜è´¨ä½œå“
- **é‡‘é¢å¥–åŠ±**ï¼šç›´æ¥çš„ç°é‡‘æ¿€åŠ±ï¼Œæå‡å‚ä¸åŠ¨åŠ›

---

## ğŸŒŸ æ–°äººä»»åŠ¡ï¼ˆä¸€æ¬¡æ€§ï¼Œé—¨æ§›ä½ï¼‰

æ–°äººä»»åŠ¡ç›®çš„ï¼š**å¿«é€Ÿå¼•å¯¼æ–°ç”¨æˆ·å®Œæˆå…³é”®è¡Œä¸ºï¼ŒåŸ¹å…»åˆ›ä½œä¹ æƒ¯**

| ä»»åŠ¡ | æ¡ä»¶ | å¥–åŠ± | è®¾è®¡ç›®çš„ |
|------|------|------|----------|
| ğŸ¬ **é¦–å‘ä½œå“** | å‘å¸ƒç¬¬1ä¸ªä½œå“ | Â¥0.5 | å¿«é€Ÿè½¬åŒ–ä¸ºåˆ›ä½œè€… |
| â¤ï¸ **é¦–è·3èµ** | ä½œå“è·å¾—3ä¸ªèµ | Â¥1.0 | å¼•å¯¼åˆ†äº«æ±‚èµâ†’è£‚å˜ |
| ğŸ‘ï¸ **é¦–è·10æ’­æ”¾** | ä½œå“è·å¾—10æ¬¡æ’­æ”¾ | Â¥0.5 | é¼“åŠ±ä¼ æ’­ |
| ğŸ‘¥ **é¦–æ¬¡é‚€è¯·** | æˆåŠŸé‚€è¯·1äºº | Â¥2.0 | æ ¸å¿ƒè£‚å˜ä»»åŠ¡ |

> ğŸ’¡ **æ€»è®¡ï¼šæ–°äººå®Œæˆå…¨éƒ¨ä»»åŠ¡å¯å¾— Â¥4.0**

### å…³é”®è®¾è®¡æ€è·¯

- "é¦–è·3èµ"åªéœ€3ä¸ªèµï¼Œç”¨æˆ·å¤§æ¦‚ç‡ä¼šåˆ†äº«ç»™æœ‹å‹æ±‚èµ â†’ **è‡ªç„¶è£‚å˜**
- å¥–åŠ±é‡‘é¢å°ä½†å³æ—¶ï¼Œç»™ç”¨æˆ·æ­£å‘åé¦ˆ
- é—¨æ§›æä½ï¼Œäººäººå¯å®Œæˆ

---

## ğŸ“ˆ ä½œå“æ¿€åŠ±ï¼ˆæŒç»­å¥–åŠ±ï¼‰

ä½œå“é‡Œç¨‹ç¢‘å¥–åŠ±ï¼š**é¼“åŠ±åˆ›ä½œä¼˜è´¨å†…å®¹**

| é‡Œç¨‹ç¢‘ | æ¡ä»¶ | å¥–åŠ± |
|--------|------|------|
| ğŸ”¥ çƒ­é—¨ä½œå“ | å•ä½œå“è·100èµ | Â¥5.0 |
| ğŸ”¥ğŸ”¥ çˆ†æ¬¾ä½œå“ | å•ä½œå“è·500èµ | Â¥20.0 |
| ğŸ”¥ğŸ”¥ğŸ”¥ è¶…çº§çˆ†æ¬¾ | å•ä½œå“è·1000èµ | Â¥50.0 |

### è¡¥å……è§„åˆ™

- æ¯ä¸ªä½œå“çš„é‡Œç¨‹ç¢‘å¥–åŠ±åªèƒ½é¢†å–ä¸€æ¬¡
- è¾¾åˆ°æ›´é«˜é‡Œç¨‹ç¢‘æ—¶ï¼Œåªå‘æ”¾å·®é¢å¥–åŠ±ï¼ˆæˆ–å…¨é¢ï¼Œå¾…å®šï¼‰

---

## ğŸ‘¥ é‚€è¯·æ¿€åŠ±ï¼ˆè£‚å˜æ ¸å¿ƒï¼‰

| ä»»åŠ¡ | æ¡ä»¶ | å¥–åŠ± |
|------|------|------|
| ğŸ é‚€è¯·æ–°äºº | æ¯æˆåŠŸé‚€è¯·1äºº | Â¥2.0 |
| ğŸ“¹ å¾’å¼Ÿå‘å¸ƒ | é‚€è¯·çš„äººå‘å¸ƒä½œå“ | Â¥0.5/ä¸ªï¼ˆä¸Šé™10ä¸ªï¼‰ |
| ğŸ’° å¸ˆå¾’åˆ†æ¶¦ | å¾’å¼Ÿä½œå“è·èµ | 10%åˆ†æ¶¦ï¼ˆå¯é€‰ï¼‰ |

### é‚€è¯·è§„åˆ™

- è¢«é‚€è¯·äººéœ€é€šè¿‡é‚€è¯·é“¾æ¥é¦–æ¬¡å¯åŠ¨Bot
- å¾’å¼Ÿå‘å¸ƒå¥–åŠ±ä¸Šé™10ä¸ªä½œå“ï¼Œé˜²æ­¢åˆ·é‡
- å¸ˆå¾’åˆ†æ¶¦å¯ä½œä¸ºé•¿æœŸæ¿€åŠ±ï¼ˆå¯é€‰åŠŸèƒ½ï¼‰

---

## ğŸ“… æ¯æ—¥ä»»åŠ¡ï¼ˆå¯é€‰ï¼Œæå‡æ—¥æ´»ï¼‰

| ä»»åŠ¡ | æ¡ä»¶ | å¥–åŠ± |
|------|------|------|
| ğŸ“± æ¯æ—¥ç­¾åˆ° | æ‰“å¼€App | Â¥0.1 |
| ğŸ‘€ æ¯æ—¥æµè§ˆ | çœ‹10ä¸ªè§†é¢‘ | Â¥0.1 |
| â¤ï¸ æ¯æ—¥ç‚¹èµ | ç‚¹èµ5ä¸ªè§†é¢‘ | Â¥0.1 |
| ğŸ“¤ æ¯æ—¥åˆ†äº« | åˆ†äº«1ä¸ªè§†é¢‘ | Â¥0.2 |

> âš ï¸ æ¯æ—¥ä»»åŠ¡é‡‘é¢å°ï¼Œä¸»è¦ç›®çš„æ˜¯æå‡æ—¥æ´»ï¼Œå¯åæœŸå†åš

---

## ğŸ’¾ æ•°æ®åº“è®¾è®¡

### 1. ç”¨æˆ·ä½™é¢ï¼ˆprofiles è¡¨æ–°å¢å­—æ®µï¼‰

```sql
ALTER TABLE profiles ADD COLUMN balance INTEGER DEFAULT 0; -- ä½™é¢ï¼ˆå•ä½ï¼šåˆ†ï¼‰
ALTER TABLE profiles ADD COLUMN total_earned INTEGER DEFAULT 0; -- ç´¯è®¡æ”¶ç›Šï¼ˆå•ä½ï¼šåˆ†ï¼‰
```

### 2. ä»»åŠ¡å®šä¹‰è¡¨

```sql
CREATE TABLE tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  code VARCHAR(50) UNIQUE NOT NULL, -- ä»»åŠ¡ä»£ç ï¼Œå¦‚ newbie_first_publish
  name VARCHAR(100) NOT NULL, -- ä»»åŠ¡åç§°
  description TEXT, -- ä»»åŠ¡æè¿°
  task_type VARCHAR(20) NOT NULL, -- newbie/milestone/daily/invite
  condition_type VARCHAR(30) NOT NULL, -- publish/like_received/view/invite
  condition_value INTEGER NOT NULL DEFAULT 1, -- è¾¾æˆæ•°é‡
  reward_amount INTEGER NOT NULL DEFAULT 0, -- å¥–åŠ±é‡‘é¢ï¼ˆå•ä½ï¼šåˆ†ï¼‰
  is_active BOOLEAN DEFAULT true,
  sort_order INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT now()
);

-- é¢„ç½®æ–°äººä»»åŠ¡
INSERT INTO tasks (code, name, description, task_type, condition_type, condition_value, reward_amount, sort_order) VALUES
('newbie_first_publish', 'é¦–å‘ä½œå“', 'å‘å¸ƒä½ çš„ç¬¬1ä¸ªä½œå“', 'newbie', 'publish', 1, 50, 1),
('newbie_first_3_likes', 'é¦–è·3èµ', 'ä½œå“ç´¯è®¡è·å¾—3ä¸ªèµ', 'newbie', 'like_received', 3, 100, 2),
('newbie_first_10_views', 'é¦–è·10æ’­æ”¾', 'ä½œå“ç´¯è®¡è·å¾—10æ¬¡æ’­æ”¾', 'newbie', 'view', 10, 50, 3),
('newbie_first_invite', 'é¦–æ¬¡é‚€è¯·', 'æˆåŠŸé‚€è¯·1ä½å¥½å‹', 'newbie', 'invite', 1, 200, 4);

-- é¢„ç½®ä½œå“é‡Œç¨‹ç¢‘ä»»åŠ¡
INSERT INTO tasks (code, name, description, task_type, condition_type, condition_value, reward_amount, sort_order) VALUES
('milestone_100_likes', 'çƒ­é—¨ä½œå“', 'å•ä½œå“è·å¾—100èµ', 'milestone', 'single_video_likes', 100, 500, 10),
('milestone_500_likes', 'çˆ†æ¬¾ä½œå“', 'å•ä½œå“è·å¾—500èµ', 'milestone', 'single_video_likes', 500, 2000, 11),
('milestone_1000_likes', 'è¶…çº§çˆ†æ¬¾', 'å•ä½œå“è·å¾—1000èµ', 'milestone', 'single_video_likes', 1000, 5000, 12);
```

### 3. ç”¨æˆ·ä»»åŠ¡è¿›åº¦è¡¨

```sql
CREATE TABLE user_tasks (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES profiles(id),
  task_id UUID NOT NULL REFERENCES tasks(id),
  progress INTEGER DEFAULT 0, -- å½“å‰è¿›åº¦
  completed BOOLEAN DEFAULT false,
  claimed BOOLEAN DEFAULT false, -- æ˜¯å¦å·²é¢†å–å¥–åŠ±
  completed_at TIMESTAMPTZ,
  claimed_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(user_id, task_id)
);

-- ç´¢å¼•
CREATE INDEX idx_user_tasks_user_id ON user_tasks(user_id);
CREATE INDEX idx_user_tasks_completed ON user_tasks(user_id, completed);
```

### 4. å¥–åŠ±æµæ°´è¡¨

```sql
CREATE TABLE reward_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES profiles(id),
  task_id UUID REFERENCES tasks(id),
  amount INTEGER NOT NULL, -- é‡‘é¢ï¼ˆå•ä½ï¼šåˆ†ï¼‰
  reason VARCHAR(100), -- å¥–åŠ±åŸå› 
  related_id UUID, -- å…³è”IDï¼ˆå¦‚è§†é¢‘IDã€è¢«é‚€è¯·äººIDï¼‰
  created_at TIMESTAMPTZ DEFAULT now()
);

-- ç´¢å¼•
CREATE INDEX idx_reward_logs_user_id ON reward_logs(user_id);
CREATE INDEX idx_reward_logs_created_at ON reward_logs(created_at);
```

### 5. ä½œå“é‡Œç¨‹ç¢‘è®°å½•è¡¨ï¼ˆé˜²æ­¢é‡å¤é¢†å–ï¼‰

```sql
CREATE TABLE video_milestones (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  video_id UUID NOT NULL REFERENCES videos(id),
  user_id UUID NOT NULL REFERENCES profiles(id),
  milestone_type VARCHAR(30) NOT NULL, -- likes_100/likes_500/likes_1000
  claimed BOOLEAN DEFAULT false,
  claimed_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT now(),
  UNIQUE(video_id, milestone_type)
);
```

---

## ğŸ”„ ä»»åŠ¡è§¦å‘æ—¶æœº

| è§¦å‘äº‹ä»¶ | æ£€æŸ¥çš„ä»»åŠ¡ |
|----------|------------|
| ç”¨æˆ·å‘å¸ƒè§†é¢‘ | newbie_first_publish |
| è§†é¢‘è¢«ç‚¹èµ | newbie_first_3_likes, milestone_*_likes |
| è§†é¢‘è¢«æ’­æ”¾ | newbie_first_10_views |
| é‚€è¯·æˆåŠŸ | newbie_first_invite |
| å¾’å¼Ÿå‘å¸ƒä½œå“ | invite_apprentice_publish |

---

## ğŸ“± å‰ç«¯å±•ç¤º

### Bot ä¸ªäººä¸­å¿ƒ

```
ğŸ‘¤ ä¸ªäººä¸­å¿ƒ

ğŸ’° ä½™é¢ï¼šÂ¥12.50
ğŸ“Š ç´¯è®¡æ”¶ç›Šï¼šÂ¥25.00

ğŸ“‹ ä»»åŠ¡ä¸­å¿ƒ â†’
```

### ä»»åŠ¡ä¸­å¿ƒé¡µé¢

```
ğŸ¯ æ–°äººä»»åŠ¡

âœ… é¦–å‘ä½œå“ - å·²å®Œæˆ +Â¥0.5
ğŸ”„ é¦–è·3èµ - è¿›åº¦ 1/3
â¬œ é¦–è·10æ’­æ”¾ - æœªå¼€å§‹
â¬œ é¦–æ¬¡é‚€è¯· - æœªå¼€å§‹

---

ğŸ† ä½œå“æˆå°±

ğŸ”¥ çƒ­é—¨ä½œå“(100èµ) - Â¥5.0
ğŸ”¥ğŸ”¥ çˆ†æ¬¾ä½œå“(500èµ) - Â¥20.0
ğŸ”¥ğŸ”¥ğŸ”¥ è¶…çº§çˆ†æ¬¾(1000èµ) - Â¥50.0
```

---

## âš ï¸ é£æ§è€ƒè™‘

1. **åˆ·é‡é˜²æŠ¤**ï¼šåŒä¸€è®¾å¤‡/IP çš„ç‚¹èµä¸è®¡å…¥
2. **æç°é—¨æ§›**ï¼šä½™é¢æ»¡ Â¥10 å¯æç°
3. **æ¯æ—¥ä¸Šé™**ï¼šæ¯æ—¥ä»»åŠ¡å¥–åŠ±è®¾ä¸Šé™
4. **äººå·¥å®¡æ ¸**ï¼šå¤§é¢å¥–åŠ±éœ€äººå·¥å®¡æ ¸

---

## ğŸ“ TODO

- [ ] æ•°æ®åº“è¿ç§»
- [ ] ä»»åŠ¡æ£€æŸ¥é€»è¾‘
- [ ] Bot ä»»åŠ¡ä¸­å¿ƒå…¥å£
- [ ] å¥–åŠ±å‘æ”¾é€»è¾‘
- [ ] ä½™é¢å±•ç¤º
- [ ] æç°åŠŸèƒ½ï¼ˆåæœŸï¼‰

